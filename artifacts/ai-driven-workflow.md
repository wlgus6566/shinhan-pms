# AI-Driven Workflow

## 1. 개요

### 1.1 정의

AI-Driven Workflow는 AI 에이전트들이 소프트웨어 개발의 전 과정(기획 - 설계 - 개발 - 테스트)을 수행하고, 사람(PM)이 각 단계별 산출물을 검수하는 개발 방식입니다.

```
전통적 워크플로우: 사람이 작업 → 사람이 검수
AI-Driven 워크플로우: AI가 작업 → 사람이 검수
```

### 1.2 목적

| 목적        | 설명                                                          |
| ----------- | ------------------------------------------------------------- |
| 생산성 향상 | 반복적이고 정형화된 작업을 AI가 수행하여 개발 속도 향상       |
| 품질 일관성 | 문서화된 규칙(에이전트 정의)에 따라 일관된 품질의 산출물 생성 |
| 지식 축적   | 암묵지를 규칙으로 명시화하여 조직 차원의 지식 자산화          |
| 확장성      | 규칙 개선을 통해 AI 에이전트의 역량을 지속적으로 향상         |

### 1.3 핵심 철학

> **"마음에 안 드는 결과가 나오면 결과물을 고치기보다 규칙을 고친다"**

- 결과물을 수정하면 일회성 개선에 그침
- 규칙(에이전트 정의)을 수정하면 영구적인 개선이 됨
- 이를 통해 AI 에이전트가 조직의 기준에 맞게 진화함

---

## 2. 에이전트 체계

### 2.1 에이전트 구성

```
PM (프로젝트 관리)
├── Planner (기획자)
├── Wireframe (와이어프레임)
├── Modeler (DB 모델러)
├── Developer (풀스택 개발자)
└── Git (버전관리) [예정]
```

### 2.2 에이전트별 역할

| 에이전트      | 역할                                     | 모델 | 산출물 위치 |
| ------------- | ---------------------------------------- | ---- | ----------- |
| **PM**        | 프로젝트 통합 관리, 팀원 조율, 품질 검수 |
| **Planner**   | 요구사항 정의, 사용자 스토리, 기능 명세  |
| **Modeler**   | Prisma 스키마 작성, ERD, DDL/DML         |
| **Developer** | NestJS API, Next.js UI, 테스트           |

### 2.3 에이전트 정의 파일

에이전트의 행동 규칙은 `.claude/agents/` 디렉토리에 마크다운 파일로 정의됩니다.

```
.claude/agents/
├── pm.md           # PM 에이전트 규칙
├── planner.md      # 기획자 규칙
├── modeler.md      # DB 모델러 규칙
└── developer.md    # 개발자 규칙
```

**에이전트 정의 파일 구조**

```markdown
---
name: planner
description: 기획자. 기획서, 요구사항 정의, 사용자 스토리 작성
tools: Read, Write, Edit, Grep, Glob
model: opus
---

(에이전트의 역할, 원칙, 산출물 형식, 체크리스트 등)
```

---

## 3. 워크플로우

### 3.1 전체 흐름

```
┌─────────────────────────────────────────────────────────────────────┐
│                        PM (조율 및 검수)                              │
└─────────────────────────────────────────────────────────────────────┘
          │
          ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   1. Planner    │ → │  2. Wireframe   │ → │   3. Modeler    │ → │  4. Developer   │
│     (기획)      │    │   (화면 설계)    │    │   (DB 설계)     │    │     (개발)      │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
         │                     │                     │                     │
         ▼                     ▼                     ▼                     ▼
    기획서.md              HTML 파일          스키마.md + .sql         API + UI 코드
                                              schema.prisma
```

### 3.2 단계별 프로세스

#### Step 1: 요청 접수 및 기획 (PM + Planner)

```
PM: "회원 관리 기능을 개발해주세요"
    │
    ▼
Planner: 요구사항 대화 (최소 3-5회 Q&A)
    │
    ▼
Planner: 요구사항 요약 및 확인
    │
    ▼
PM: 검수 및 승인
    │
    ▼
Planner: 기획서 작성 → artifacts/planning-user-story/{feature}.md
```

**검수 포인트 (기획서)**

- [ ] 목적과 범위가 명확한가?
- [ ] 사용자 스토리와 인수 조건이 구체적인가?
- [ ] 화면 흐름이 논리적인가?
- [ ] API 경로가 RESTful 컨벤션을 따르는가?

#### Step 2: 화면 설계 (Wireframe)

```
Wireframe: 기획서 참조
    │
    ▼
Wireframe: HTML 와이어프레임 작성
    │
    ▼
PM: 검수 (로컬 서버로 확인)
    │
    ▼
Wireframe: 수정 반영 → artifacts/planning-wireframe/{feature}/
```

**검수 포인트 (와이어프레임)**

- [ ] 기획서의 모든 화면이 구현되었는가?
- [ ] 화면 간 이동 링크가 정상 동작하는가?
- [ ] 필수 입력 필드가 모두 표시되는가?
- [ ] 버튼/액션 레이블이 명확한가?

```bash

```

#### Step 3: DB 설계 (Modeler)

```
Modeler: 기획서 + 와이어프레임 참조
    │
    ▼
Modeler: 테이블 명세 작성 → artifacts/database-schema/{domain}/{domain}.md
    │
    ▼
Modeler: DDL/DML 작성 → artifacts/database-schema/{domain}/{domain}.sql
    │
    ▼
Modeler: Prisma 스키마 작성 → sources/prisma/schema.prisma
    │
    ▼
PM: 검수
    │
    ▼
Modeler: 마이그레이션 실행 (승인 후)
```

**검수 포인트 (DB 스키마)**

- [ ] 공통 컬럼(is_active, created_at 등)이 포함되었는가?
- [ ] 명명 규칙(snake_case)을 따르는가?
- [ ] 인덱스가 적절히 설계되었는가?
- [ ] 외래 키 관계가 올바른가?
- [ ] 초기 데이터(공통코드 등)가 정의되었는가?

#### Step 4: 개발 (Developer)

```
Developer: 기획서 + 와이어프레임 + DB 스키마 참조
    │
    ├── 백엔드 개발 (NestJS)
    │   ├── 테스트 먼저 작성 (TDD)
    │   ├── 서비스 구현
    │   ├── 컨트롤러 구현
    │   └── Swagger 문서화
    │
    ├── 프론트엔드 개발 (Next.js + shadcn/ui)
    │   ├── API 클라이언트 작성
    │   ├── CSR(Client-Side Rendering) 방식으로 구현
    │   ├── 컴포넌트 구현
    │   └── 페이지 구현 (useEffect 기반 데이터 페칭)
    │
    ▼
PM: 검수 (테스트 통과, API 동작, UI 확인)
```

**검수 포인트 (개발)**

- [ ] 단위 테스트가 작성되고 통과하는가?
- [ ] API가 Swagger 문서에 표시되는가?
- [ ] 기획서의 모든 기능이 구현되었는가?
- [ ] 와이어프레임과 UI가 일치하는가?
- [ ] **CSR 방식으로 구현되어 서버 측 페칭 없이 클라이언트에서 동작하는가?**
- [ ] 에러 처리가 적절한가?

---

## 5. 검수(Review) 프로세스

### 5.1 검수 원칙

PM은 각 에이전트의 산출물을 다음 단계로 넘기기 전에 검수합니다.

```
에이전트 작업 완료
      │
      ▼
  PM 검수
      │
      ├── 통과 → 다음 단계로 진행
      │
      └── 반려 → 수정 요청
              │
              ├── 단순 수정 → 결과물 직접 수정
              │
              └── 반복 이슈 → 규칙 수정 (에이전트 정의 업데이트)
```

### 5.2 단계별 검수 체크리스트

#### 기획서 검수

```markdown
- [ ] 목적/배경/범위가 명확한가?
- [ ] 기능 요구사항(FR)이 우선순위와 함께 정의되었는가?
- [ ] 비기능 요구사항(NFR)에 수치 기준이 있는가?
- [ ] 사용자 스토리에 인수 조건이 있는가?
- [ ] 화면 목록과 흐름이 정의되었는가?
- [ ] API 경로가 RESTful 컨벤션을 따르는가?
- [ ] 초기 데이터(도메인 코드)가 정의되었는가?
- [ ] 예외 처리 케이스가 정의되었는가?
```

#### 와이어프레임 검수

```markdown
- [ ] 기획서의 모든 화면이 HTML로 작성되었는가?
- [ ] 화면 간 링크가 정상 동작하는가?
- [ ] 필수 입력 필드에 \* 표시가 있는가?
- [ ] 버튼/액션 레이블이 명확한가?
- [ ] 에러 메시지 영역이 표시되는가?
- [ ] 다크모드 스타일이 적용되었는가?
```

#### DB 스키마 검수

```markdown
- [ ] 공통 컬럼(is_active, created_by, created_at 등)이 포함되었는가?
- [ ] 테이블/컬럼 명명 규칙(snake_case)을 따르는가?
- [ ] 적절한 인덱스가 설계되었는가?
- [ ] 외래 키 관계가 올바른가?
- [ ] 컬럼 코멘트가 작성되었는가?
- [ ] Prisma 스키마와 DDL이 동기화되었는가?
- [ ] 초기 데이터(DML)가 작성되었는가?
```

#### 개발 검수

```markdown
- [ ] 단위 테스트가 작성되고 통과하는가?
- [ ] Swagger 문서에 API가 표시되는가?
- [ ] 기획서의 모든 기능이 구현되었는가?
- [ ] 와이어프레임과 UI가 일치하는가?
- [ ] 에러 처리가 적절한가?
- [ ] 코드 컨벤션을 따르는가?
```

---

## 6. 규칙 기반 학습

### 6.1 개념

AI-Driven Workflow의 핵심은 **규칙(에이전트 정의)의 지속적인 개선**입니다.

```
문제 발생
    │
    ▼
원인 분석
    │
    ├── 에이전트 규칙 누락 → 규칙 추가
    │
    ├── 에이전트 규칙 모호 → 규칙 명확화
    │
    └── 에이전트 규칙 오류 → 규칙 수정
```

### 6.2 규칙 개선 사례

#### 사례 1: 공통 컬럼 누락

**문제**: Modeler가 테이블 생성 시 공통 컬럼(is_active, created_at 등)을 빠뜨림

**해결**: `modeler.md`에 공통 컬럼 섹션 추가

```markdown
## 공통 컬럼 (필수)

> **모든 테이블에 반드시 포함해야 하는 필수 컬럼**

| 컬럼       | 타입                                | 설명     |
| ---------- | ----------------------------------- | -------- |
| id         | BIGSERIAL / UUID                    | PK       |
| is_active  | BOOLEAN DEFAULT TRUE                | 활성여부 |
| created_by | BIGINT                              | 생성자   |
| created_at | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | 생성일시 |

| ...
```

#### 사례 2: 기획서 과도한 상세화

**문제**: Planner가 DDL, API Request/Response까지 상세하게 작성하여 역할 중복

**해결**: `planner.md`에 범위 제외 섹션 추가

```markdown
## 기획서 범위 (역할 분리)

### 제외 (다른 에이전트 담당)

| 항목                           | 담당      | 왜 제외?                 |
| ------------------------------ | --------- | ------------------------ |
| DDL/테이블 상세 설계           | modeler   | DB 설계 전문성 필요      |
| API Request/Response 상세 JSON | developer | 구현 단계에서 결정       |
| 화면 상세 레이아웃 (HTML)      | wireframe | 와이어프레임 전문성 필요 |
```

#### 사례 3: 와이어프레임 CORS 오류

**문제**: Wireframe이 사이드바를 fetch로 로드하여 로컬 파일에서 CORS 오류 발생

**해결**: `wireframe.md`에 직접 임베드 방식으로 변경

```markdown
## 사이드바 (직접 임베드 방식)

> **중요**: 사이드바는 각 HTML 파일에 직접 임베드합니다.
> (fetch 방식은 로컬 파일에서 CORS 오류 발생)
```

### 6.3 규칙 개선 프로세스

```
1. 문제 발생 → PM이 이슈 식별

2. 원인 분석 → 어떤 에이전트의 어떤 규칙이 문제인지 파악

3. 규칙 수정 → .claude/agents/{agent}.md 수정
   - 누락된 규칙 추가
   - 모호한 규칙 명확화
   - 잘못된 규칙 수정

4. 검증 → 다음 작업에서 개선 확인

5. 문서화 → Best Practice 섹션에 사례 추가
```

---

## 7. 장점과 기대 효과

### 7.1 장점

| 장점            | 설명                                |
| --------------- | ----------------------------------- |
| **속도**        | 정형화된 문서/코드 작성 속도 향상   |
| **일관성**      | 규칙에 따른 일관된 품질의 산출물    |
| **확장성**      | 규칙 개선으로 AI 역량 지속 향상     |
| **지식 자산화** | 암묵지를 명시적 규칙으로 변환       |
| **온보딩**      | 신규 팀원이 규칙 문서로 빠르게 학습 |

### 7.2 기대 효과

```
[ 단기 ]
- 반복 작업 시간 절감 (기획서 템플릿, 보일러플레이트 코드)
- 품질 편차 감소 (체크리스트 기반 검수)

[ 중기 ]
- 조직 표준 정립 (코드 컨벤션, 문서 형식)
- 개발 프로세스 표준화

[ 장기 ]
- 조직 지식 축적 (규칙 문서 = 조직 노하우)
- AI 에이전트 역량 고도화 (지속적 규칙 개선)
```

---

## 8. 운영 가이드

### 8.1 에이전트 호출 방법

Claude Code에서 에이전트를 호출하는 방법:

```bash
# 터미널에서
claude-code --agent planner "프로젝트 관리 기능 기획해줘"

# 또는 Claude Code 내에서
@planner 프로젝트 관리 기능 기획해줘
```

### 8.2 PM 일일 업무

```
1. artifacts/todo.md 확인 → 현재 진행 상황 파악

2. 에이전트 작업 지시 → 기능 개발 요청

3. 산출물 검수 → 체크리스트 기반 검토

4. 피드백 반영 → 수정 요청 또는 규칙 개선

5. TODO 업데이트 → 진행 상황 반영
```

### 8.3 에이전트 정의 수정

에이전트 규칙을 수정할 때:

```
1. .claude/agents/{agent}.md 파일 수정

2. 수정 내용:
   - 역할/원칙 명확화
   - 체크리스트 추가/수정
   - Best Practice 사례 추가
   - 산출물 형식 개선

3. 수정 후 다음 작업에서 효과 확인
```

---
